%META:TOPICINFO{author="BaseUserMapping_333" comment="" date="1319162198" format="1.1" version="2"}%
%META:TOPICPARENT{name="Plugins"}%
---+ !OpenLayers Plugin

%SHORTDESCRIPTION%

Learn how to create your own plugin in %SYSTEMWEB%.DevelopingPlugins.

---++ Plugin Preferences

Plugin preferences should be set using =configure=, as described in
%SYSTEMWEB%.DevelopingPlugins. You can also use
[[%SYSTEMWEB%.PreferenceSettings][preference settings]] to define any
user-controllable configuration. You are strongly advised
to use the name of the plugin as a prefix, to avoid the risk of namespace
clashes with other extensions that may try to use the same name.

*BAD*
   * Set EXAMPLE = Example setting
   * Set FORMAT = %d-%m-%y
*Good*
   * Set EMPTYPLUGIN_EXAMPLE = Example setting
   * Set EMPTYPLUGIN_FORMAT = %d-%m-%y
<!--
One line description, required for extensions repository catalog.
   * Set SHORTDESCRIPTION = %$SHORTDESCRIPTION%
-->

!OpenLayersMap renders a map using the !OpenLayer javascript library.
---++ Syntax

=%<nop>OPENLAYERSMAP{mapwidth="800" mapheight="600"}%=

render a [[http://www.demis.nl][DEMIS]] world map

| *Parameter* | *Description* | *Example* | *Default* |
| =mapwidth= | the width of the map div | | full screen width |
| =mapheight= |  the height of the map div | | =600= |
| =mapelement= |  the html div element in which the map will be rendered  | | =openlayersmap= |
| =viewport= | the longitude,latitude or the web.topic name of the layer (listed in =layers=) which will be used to set the bounds of the viewport | | =159,-38= |
| =viewportzoom= | the default zoom level of viewport, -1 = no zoom. Values range from 1...n-1 (n = mapnumzoomlevels) | | =-1= |
| =layers= | comma separated list of topics, each with an defined [[%SCRIPTURL{view}%/%WEB%.%TOPIC%#Defined_Forms][OpenLayers form attached]]  | | If no layers exist the default Demis map is rendered |


Example

<verbatim class="tml">
%OPENLAYERSMAP{
   mapwidth="n600"
   viewport="159,-32"
   viewport1="Applications/OpenLayers/Layers/ALA_GreatBarrierReef"
   viewportzoom="-1"
   mapprojection="EPSG:4326"
   layertopics="Applications/OpenLayers/Layers/DefaultMap,Applications/OpenLayers/Layers/Demis_Layer,Applications/OpenLayers/Layers/ALA_GreatBarrierReef,Applications/OpenLayers/Layers/TRIN_Specimens,Applications/OpenLayers/Layers/MyKMLFeatures"
   mapelement="myMap"
   styleobject=""
   basetopics=""
   }%   
</verbatim>


Preview
%OPENLAYERSMAP{
   mapwidth="n600"
   viewport="159,-32"
   viewport1="Applications/OpenLayers/Layers/ALA_GreatBarrierReef"
   viewportzoom="-1"
   mapprojection="EPSG:4326"
   layertopics="Applications/OpenLayers/Layers/DefaultMap,Applications/OpenLayers/Layers/Demis_Layer,Applications/OpenLayers/Layers/ALA_GreatBarrierReef,Applications/OpenLayers/Layers/TRIN_Specimens,Applications/OpenLayers/Layers/MyKMLFeatures"
   mapelement1="myMap"
   styleobject=""
   basetopics=""
   }%
<div id="myMap" style="position:relative;"></div>



---++ Defined Forms
OpenLayers comes installed with dataforms defining various layers that can be rendered.
Set the Web Preferences to point the variable OPENLAYERSPLUGIN_MAPSWEB to the location of these forms and add links for these forms the WEBFORMS varaible in your [[WebPreferences]] that are used

---+++ Defining your own forms
Below is a table of the various Layer types and variables which can be set from a layer form. Ensure you attach the [[Applications/OpenLayers/LayerTypeForm][LayerTypeForm]] and set the value of LayerType to the one of (google, kml, vector, wfs, wms, or worldwind).
|*LayerType*|*Fields*|*sample*|
|google| | |
|kml|Name,URL,Clustering|MyKMLFeatures|
|vector|Name,URL,Clustering|Wiki|
|wfs| | |
|wms|Name,URL, ServerParams{Object}, ClientOptions{Object}|[[%OPENLAYERSPLUGIN_MAPSWEB%.WMSLayerForm][ALA_GreatBarrierReef]]|
|worldwind|Name,URL,TileSize,ZoomLevels,ServerParams,ClientOptions,IsBaseLayer,IsVisible|[[%OPENLAYERSPLUGIN_MAPSWEB%.WorldWindForm][Demis]]|

---++ Installation

%$INSTALL_INSTRUCTIONS%

---++ Plugin Info

|  Author: | Foswiki:Main.PaulAlexander |
|  Copyright: | Â© 2011, [[http://taxonomy.org.au][Taxonomy Research & Information Network]], Foswiki Contributors %BR%\ This plugin uses [[http://openlayers.org][OpenLayers]] javascript, which is Copyright (c) !OpenLayers Contributors, see [[%ATTACHURLPATH%/scripts/api/2/doc/authors.txt][authors.txt]] |
|  License: | This Foswiki plugin is licensed under the GPL ([[http://www.gnu.org/copyleft/gpl.html][GNU General Public License Version 3]])%BR% \
This plugin uses [[http://openlayers.org][OpenLayers]] javascript, which is licensed under the [[%ATTACHURLPATH%/scripts/api/2/license.txt][2-clause BSD License]], which in turn includes code licensed under the [[%ATTACHURLPATH%/scripts/api/2/doc/licenses/APACHE-2.0.txt][Apache 2.0]] and [[%ATTACHURLPATH%/scripts/api/2/doc/licenses/MIT-LICENSE.txt][MIT]] licenses. See [[%ATTACHURLPATH%/scripts/api/2/OpenLayers.js][OpenLayers.js]] for full copyright headers and notices. |
|  Release: | %$RELEASE% |
|  Version: | %$VERSION% |
|  Change History: | <!-- versions below in reverse order --> |
|  XX Mmm 20XX (1.0) | Description of change |
|  Home: | http://foswiki.org/Extensions/%TOPIC% |
|  Support: | http://foswiki.org/Support/%TOPIC% |
